<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>14 —Ñ–µ–≤—Ä–∞–ª—è üíå</title>
  <style>
    :root{
      /* ONLY 3 COLORS */
      --white:#ffffff;
      --pink:#ffd3e6;
      --red:#ff2d55;

      --shadow: 0 18px 45px rgba(0,0,0,.14);
      --shadow2: 0 10px 25px rgba(0,0,0,.12);
      --r:22px;
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bot: env(safe-area-inset-bottom, 0px);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-rounded, -apple-system, BlinkMacSystemFont, "SF Pro Display","SF Pro Text", system-ui, "Segoe UI", Roboto, Arial, sans-serif;
      color:rgba(0,0,0,.82);
      overflow:hidden;
      background:
        radial-gradient(1100px 700px at 20% 10%, var(--white) 0%, rgba(255,255,255,0) 55%),
        radial-gradient(900px 600px at 90% 25%, rgba(255,45,85,.18) 0%, rgba(255,45,85,0) 55%),
        linear-gradient(180deg, var(--white) 0%, var(--pink) 45%, rgba(255,45,85,.16) 100%);
      position:relative;
    }

    /* Soft floating emojis */
    .bg{ position:absolute; inset:0; overflow:hidden; pointer-events:none; z-index:0; }
    .float{
      position:absolute;
      filter: drop-shadow(0 10px 15px rgba(0,0,0,.10));
      opacity:.95;
      transform: translate3d(0,0,0);
      animation: drift var(--dur) ease-in-out infinite;
      will-change: transform;
    }
    @keyframes drift{
      0%{ transform: translate3d(0,0,0) rotate(0deg); }
      50%{ transform: translate3d(var(--dx), var(--dy), 0) rotate(6deg); }
      100%{ transform: translate3d(0,0,0) rotate(0deg); }
    }

    /* Top overlay toasts + sheet */
    .top-layer{
      position:fixed;
      left:0; right:0;
      top: calc(12px + var(--safe-top));
      padding: 0 14px;
      z-index:50;
      pointer-events:none;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
    }
    .toast{
      width:min(420px, calc(100vw - 28px));
      background: var(--white);
      border-radius: 18px;
      box-shadow: var(--shadow2);
      padding: 12px 14px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      transform: translateY(-18px);
      opacity:0;
      animation: toastIn .42s cubic-bezier(.2,.9,.2,1) forwards;
      pointer-events:auto;
    }
    @keyframes toastIn{ to{ transform: translateY(0); opacity:1; } }
    .toast .dot{ width:10px; height:10px; border-radius:999px; background: var(--red); margin-top:6px; flex:0 0 auto; }
    .toast .t{ line-height:1.25; font-size:14px; }

    .sheetWrap{
      position:fixed; inset:0;
      z-index:60;
      display:none;
      align-items:flex-start;
      justify-content:center;
      padding-top: calc(10px + var(--safe-top));
      pointer-events:none;
    }
    .sheetWrap.show{ display:flex; }
    .sheetBackdrop{
      position:absolute; inset:0;
      background: rgba(255,45,85,.08);
      pointer-events:auto;
      opacity:0;
      animation: fadeIn .25s ease forwards;
    }
    @keyframes fadeIn{ to{opacity:1;} }
    .sheet{
      position:relative;
      width:min(440px, calc(100vw - 28px));
      background: var(--white);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 14px 14px 16px;
      transform: translateY(-22px);
      opacity:0;
      animation: sheetIn .42s cubic-bezier(.2,.95,.2,1) forwards;
      pointer-events:auto;
    }
    @keyframes sheetIn{ to{ transform: translateY(0); opacity:1; } }
    .sheet .head{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding-bottom:10px; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      background: rgba(255,45,85,.12);
      border-radius: 999px;
      padding: 8px 10px;
      font-weight:700;
      color: rgba(0,0,0,.78);
      font-size:13px;
    }
    .xbtn{
      border:none;
      background: rgba(255,45,85,.12);
      color: rgba(0,0,0,.75);
      border-radius: 12px;
      padding: 8px 10px;
      font-weight:800;
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      transition: transform .15s ease;
    }
    .xbtn:active{ transform: scale(.96); }
    .sheet p{ margin:0; font-size:14px; line-height:1.35; }

    /* App */
    .app{
      position:relative;
      z-index:1;
      height:100%;
      display:flex;
      flex-direction:column;
      padding: calc(18px + var(--safe-top)) 16px calc(18px + var(--safe-bot)) 16px;
      gap:12px;
    }

    .progress{
      display:flex; justify-content:center; gap:8px; padding-top:2px;
      opacity:0; transform: translateY(6px);
      animation: rise .7s ease .35s forwards;
    }
    @keyframes rise{ to{opacity:1; transform: translateY(0);} }
    .dotp{ width:7px;height:7px;border-radius:999px; background: rgba(255,45,85,.22); transform: scale(.96); transition:.3s ease; }
    .dotp.on{ background: var(--red); transform: scale(1.18); box-shadow: 0 8px 18px rgba(0,0,0,.10); }

    .stage{ flex:1; display:flex; align-items:center; justify-content:center; }

    .card{
      width:min(440px, 100%);
      background: var(--white);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 18px 16px 16px;
      position:relative;
      overflow:hidden;
      transform: translateY(10px);
      opacity:0;
      animation: cardIn .7s cubic-bezier(.2,.95,.2,1) forwards;
    }
    @keyframes cardIn{ to{ transform: translateY(0); opacity:1; } }
    .card::before{
      content:"";
      position:absolute;
      inset:-60px -80px auto -80px;
      height:160px;
      background: radial-gradient(closest-side, rgba(255,45,85,.12), rgba(255,45,85,0));
      transform: translateX(-10px);
      animation: glow 6s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes glow{
      0%,100%{ transform: translateX(-10px) translateY(0); opacity:.9; }
      50%{ transform: translateX(60px) translateY(12px); opacity:.55; }
    }

    .title{ margin:0 0 6px 0; font-size:22px; letter-spacing:-.2px; text-align:center; }
    .sub{ margin:0 0 12px 0; font-size:14px; text-align:center; opacity:.82; }
    .divider{ height:1px; background: rgba(255,45,85,.14); margin: 12px 0 14px; }

    /* Buttons */
    .btnRow{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
    .btn{
      border:none; cursor:pointer; -webkit-tap-highlight-color: transparent;
      padding: 12px 14px;
      border-radius: 16px;
      font-weight:800;
      font-size: 14px;
      background: rgba(255,45,85,.12);
      color: rgba(0,0,0,.82);
      transition: transform .15s ease, box-shadow .2s ease, background .2s ease, opacity .2s ease;
      position:relative; overflow:hidden;
      min-width:132px;
    }
    .btn.primary{ background: var(--red); color: var(--white); box-shadow: 0 14px 25px rgba(0,0,0,.16); }
    .btn:active{ transform: scale(.97); }
    .btn.primary:active{ transform: scale(.975); }
    .btn.disabledLike{ opacity:.45; pointer-events:none; }
    .btn::after{
      content:"";
      position:absolute; inset:-30% auto -30% -60%;
      width:55%;
      transform: rotate(18deg);
      background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.45), rgba(255,255,255,0));
      opacity:.0;
      transition: opacity .2s ease;
    }
    .btn.primary:hover::after{ opacity:.45; animation: sweep .9s ease; }
    @keyframes sweep{ from{ left:-60%; } to{ left:120%; } }

    /* Input */
    .field{ display:flex; flex-direction:column; gap:8px; margin-top:6px; }
    .label{ font-weight:800; font-size:13px; text-align:center; opacity:.82; }
    input{
      width:100%;
      border: 1px solid rgba(255,45,85,.18);
      border-radius: 16px;
      padding: 12px 14px;
      font-size: 16px;
      outline:none;
      background: rgba(255,45,85,.06);
      transition: box-shadow .2s ease, border-color .2s ease, transform .15s ease;
    }
    input:focus{
      border-color: rgba(255,45,85,.38);
      box-shadow: 0 14px 26px rgba(0,0,0,.10);
      transform: translateY(-1px);
    }

    /* Typing */
    .typing{ min-height:22px; font-weight:800; text-align:center; margin-top: 6px; }
    .typing .cursor{
      display:inline-block;
      width:8px; height:14px;
      background: rgba(255,45,85,.55);
      margin-left:6px;
      border-radius:4px;
      transform: translateY(2px);
      animation: blink .95s steps(1,end) infinite;
    }
    @keyframes blink{ 50%{opacity:0;} }

    /* Loading */
    .loaderWrap{
      margin-top: 10px;
      display:none;
      flex-direction:column;
      gap:10px;
      align-items:center;
    }
    .loaderWrap.show{ display:flex; }
    .loaderLine{
      width:100%;
      border-radius: 999px;
      height: 10px;
      background: rgba(255,45,85,.10);
      overflow:hidden;
      box-shadow: 0 10px 22px rgba(0,0,0,.08);
    }
    .bar{ height:100%; width:0%; border-radius:999px; background: var(--red); transition: width .08s linear; }
    .percent{ font-weight:900; font-size:13px; opacity:.85; letter-spacing:.3px; }

    /* Pages */
    .page{ display:none; animation: pop .45s cubic-bezier(.2,.9,.2,1); }
    .page.show{ display:block; }
    @keyframes pop{ from{ opacity:0; transform: translateY(10px) scale(.985); } to{ opacity:1; transform: translateY(0) scale(1); } }

    /* Activation panel (hidden until envelope opened) */
    .panel{
      display:none;
      opacity:0;
      transform: translateY(10px);
    }
    .panel.show{
      display:block;
      animation: panelIn .55s cubic-bezier(.2,.9,.2,1) forwards;
    }
    @keyframes panelIn{
      to{ opacity:1; transform: translateY(0); }
    }

    /* NEW: clean ‚Äúreal‚Äù envelope with triangles */
    .envelopeWrap{ display:flex; justify-content:center; margin: 8px 0 6px; }
    .env{
      width: min(330px, 90%);
      aspect-ratio: 16/11;
      position:relative;
      border-radius: 22px;
      box-shadow: var(--shadow);
      background: var(--white);
      overflow:hidden;
      transform: translateZ(0);
    }
    /* subtle inner tint (still within palette feel) */
    .env::before{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(closest-side at 50% -10%, rgba(255,45,85,.18), rgba(255,45,85,0) 60%);
      pointer-events:none;
    }

    .env-back{
      position:absolute; inset:0;
    }

    /* ‚Äúletter‚Äù that slides a bit when opened */
    .letter{
      position:absolute;
      left:10%; right:10%;
      top:18%;
      height:58%;
      background: var(--white);
      border-radius: 16px;
      box-shadow: 0 16px 30px rgba(0,0,0,.12);
      transform: translateY(18px);
      opacity:.0;
      transition: transform .7s cubic-bezier(.2,.9,.2,1), opacity .45s ease;
    }
    .letter::after{
      content:"";
      position:absolute; left:0; right:0; top:16px;
      height:10px;
      background: rgba(255,45,85,.10);
      border-radius: 10px;
      margin: 0 14px;
    }

    /* Front triangles */
    .front{
      position:absolute; inset:0;
      pointer-events:none;
    }
    /* Bottom triangle */
    .front .bottomTri{
      position:absolute;
      left:0; right:0; bottom:-2px;
      width:0; height:0;
      margin:auto;
      border-left: 50% solid transparent;
      border-right: 50% solid transparent;
      border-top: 44% solid rgba(255,45,85,.10);
      filter: drop-shadow(0 -8px 18px rgba(0,0,0,.06));
    }
    /* Left triangle */
    .front .leftTri{
      position:absolute;
      left:-2px; bottom:-2px;
      width:0; height:0;
      border-top: 44% solid transparent;
      border-bottom: 44% solid transparent;
      border-right: 52% solid rgba(255,45,85,.07);
    }
    /* Right triangle */
    .front .rightTri{
      position:absolute;
      right:-2px; bottom:-2px;
      width:0; height:0;
      border-top: 44% solid transparent;
      border-bottom: 44% solid transparent;
      border-left: 52% solid rgba(255,45,85,.07);
    }

    /* Flap triangle (opens) */
    .flap{
      position:absolute;
      left:-2px; right:-2px; top:-2px;
      width:0; height:0;
      margin:auto;
      border-left: 50% solid transparent;
      border-right: 50% solid transparent;
      border-bottom: 48% solid rgba(255,45,85,.12);
      transform-origin: 50% 8%;
      transform: rotateX(0deg);
      transition: transform .85s cubic-bezier(.2,.9,.2,1), opacity .45s ease;
      filter: drop-shadow(0 18px 22px rgba(0,0,0,.10));
    }

    .seal{
      position:absolute;
      left:50%;
      top:56%;
      transform: translate(-50%,-50%);
      width:64px; height:64px;
      border-radius: 22px;
      background: var(--red);
      color: var(--white);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:26px;
      box-shadow: 0 18px 35px rgba(0,0,0,.18);
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      transition: transform .15s ease;
      z-index:5;
    }
    .seal:active{ transform: translate(-50%,-50%) scale(.96); }

    .env.opened .flap{ transform: rotateX(165deg); opacity:.88; }
    .env.opened .seal{ animation: sealPulse 1.05s ease-in-out infinite; }
    .env.opened .letter{ transform: translateY(-6px); opacity:1; }

    @keyframes sealPulse{
      0%,100%{ transform: translate(-50%,-50%) scale(1); }
      50%{ transform: translate(-50%,-50%) scale(1.04); }
    }

    /* No button arena */
    .arena{ position:relative; height: 180px; margin-top:8px; }
    .arena .btn{ position:absolute; left:50%; transform: translateX(-50%); }
    .arena .btn:active{ transform: translateX(-50%) scale(.97); }

    /* Final */
    .finalBanner{
      background: var(--red);
      color: var(--white);
      border-radius: 18px;
      padding: 12px 14px;
      text-align:center;
      font-weight:900;
      box-shadow: 0 18px 35px rgba(0,0,0,.18);
      margin-bottom: 10px;
      animation: pop .45s cubic-bezier(.2,.9,.2,1);
    }
    .stats{
      border-radius: 18px;
      background: rgba(255,45,85,.08);
      padding: 12px 14px;
      box-shadow: 0 14px 28px rgba(0,0,0,.10);
      text-align:center;
    }
    .stats p{ margin: 8px 0; font-size:14px; line-height:1.25; }

    .timeBox{ margin-top:10px; display:grid; gap:10px; text-align:center; }
    .miniCard{
      background: var(--white);
      border-radius: 18px;
      padding: 12px 14px;
      box-shadow: 0 14px 28px rgba(0,0,0,.10);
    }
    .miniCard .k{ font-weight:900; font-size:13px; opacity:.85; }
    .miniCard .v{ margin-top:4px; font-weight:900; font-size:16px; }

    .center{text-align:center}
    .muted{opacity:.75}
    .foot{ height:10px; }
  </style>
</head>
<body>

  <div class="bg" id="bg"></div>

  <div class="top-layer" id="toastLayer"></div>

  <div class="sheetWrap" id="sheetWrap" aria-hidden="true">
    <div class="sheetBackdrop" id="sheetBackdrop"></div>
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="head">
        <div class="pill" id="sheetTitle">üíå –°–æ–æ–±—â–µ–Ω–∏–µ</div>
        <button class="xbtn" id="sheetClose">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
      <p id="sheetText"></p>
    </div>
  </div>

  <div class="app">
    <div class="progress" id="progress"></div>

    <div class="stage">
      <div class="card">

        <!-- PAGE 1 -->
        <div class="page show" id="p1">
          <h1 class="title">–ú–∞–ª–µ–Ω—å–∫–∏–π —Å—é—Ä–ø—Ä–∏–∑ üíò</h1>
          <p class="sub">–¢–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–π –ø–æ–ª—É—á–∞—Ç–µ–ª—å–Ω–∏—Ü—ã.</p>

          <div class="envelopeWrap">
            <div class="env" id="envelope">
              <div class="env-back"></div>
              <div class="letter"></div>
              <div class="flap"></div>

              <div class="front">
                <div class="leftTri"></div>
                <div class="rightTri"></div>
                <div class="bottomTri"></div>
              </div>

              <div class="seal" id="seal" title="–û—Ç–∫—Ä—ã—Ç—å">‚ù§Ô∏è</div>
            </div>
          </div>

          <!-- EVERYTHING BELOW appears ONLY after opening envelope -->
          <div class="panel" id="activationPanel">
            <div class="typing" id="typing1"></div>

            <div class="divider"></div>

            <div class="field">
              <div class="label">–í–≤–µ–¥–∏ –∏–º—è –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</div>
              <input id="nameInput" inputmode="text" autocomplete="off" placeholder="–ò–º—è" />
            </div>

            <div class="btnRow" style="margin-top:12px;">
              <button class="btn primary" id="activateBtn">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>

            <div class="loaderWrap" id="loaderWrap">
              <div class="label">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ–ª—É—á–∞—Ç–µ–ª—å‚Ä¶</div>
              <div class="loaderLine"><div class="bar" id="bar"></div></div>
              <div class="percent" id="percent">0%</div>
            </div>
          </div>
        </div>

        <!-- PAGE 2 -->
        <div class="page" id="p2">
          <h2 class="title" id="helloTitle">–ê–º–∏–Ω–∞, —Ç—ã –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω—è—Ç—å –µ–≥–æ? üíå</h2>
          <p class="sub">–°–∫–∞–∂–∏ —á–µ—Å—Ç–Ω–æ üôÇ</p>

          <div class="btnRow" style="margin-top:10px;">
            <button class="btn primary" id="yesBtn">–î–∞ ‚úÖ</button>
          </div>

          <div class="arena" id="arena">
            <button class="btn" id="noBtn">–ù–µ—Ç üôà</button>
          </div>

          <p class="center muted" style="margin:0;">–ü–æ–¥—Å–∫–∞–∑–∫–∞: ¬´–î–∞¬ª –≤—ã–≥–ª—è–¥–∏—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ üòè</p>
        </div>

        <!-- PAGE 3 -->
        <div class="page" id="p3">
          <h2 class="title">–í—ã–±–µ—Ä–∏ —Ñ–æ—Ä–º–∞—Ç –≤–Ω–∏–º–∞–Ω–∏—è üíù</h2>
          <p class="sub">–ö–∞–∫ –ø—Ä–æ—è–≤–∏—Ç—å –∑–∞–±–æ—Ç—É –∏–º–µ–Ω–Ω–æ –∫ —Ç–µ–±–µ?</p>
          <div class="divider"></div>

          <div class="btnRow">
            <button class="btn" data-gift="üåπ –¶–≤–µ—Ç—ã" data-modal="–ö–ª–∞—Å—Å–∏–∫–∞‚Ä¶ –Ω–æ –æ–Ω–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Å–µ—Ä–¥—Ü–µ üíò">üåπ –¶–≤–µ—Ç—ã</button>
            <button class="btn" data-gift="üç≠ –°–ª–∞–¥–∫–∏–π –±—É–∫–µ—Ç" data-modal="–ú–º–º‚Ä¶ –¥–≤–∞ –≤ –æ–¥–Ω–æ–º. –ö—Ä–∞—Å–∏–≤–æ –∏ –≤–∫—É—Å–Ω–æ üòã">üç≠ –°–ª–∞–¥–∫–∏–π –±—É–∫–µ—Ç</button>
            <button class="btn" data-gift="üçì –°–ª–∞–¥–∫–∞—è –∫–æ—Ä–∑–∏–Ω–∞" data-modal="–û–æ–æ, —Ç—ã —É –Ω–∞—Å —Å–ª–∞–¥–∫–æ–µ–∂–∫–∞‚Ä¶ –ø—Ä–∏–Ω—è—Ç–æ üçì">üçì –°–ª–∞–¥–∫–∞—è –∫–æ—Ä–∑–∏–Ω–∞</button>
            <button class="btn" data-gift="‚ú® –°–µ–∫—Ä–µ—Ç–Ω—ã–π" data-modal="–ù–µ–º–Ω–æ–≥–æ –∏–Ω—Ç—Ä–∏–≥–∏? –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–≤–æ–π –Ω–∞—Å—Ç—Ä–æ–π üòè">‚ú® –°–µ–∫—Ä–µ—Ç–Ω—ã–π</button>
          </div>

          <div class="btnRow" style="margin-top:14px;">
            <button class="btn primary" id="to4" disabled style="opacity:.6;">–î–∞–ª—å—à–µ ‚ûú</button>
          </div>
        </div>

        <!-- PAGE 4 -->
        <div class="page" id="p4">
          <h2 class="title">–í—ã–±–µ—Ä–∏ —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è üöö</h2>
          <p class="sub">–¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –Ω–æ —Å–∞–º—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.</p>
          <div class="divider"></div>

          <div class="btnRow">
            <button class="btn" id="deliveryBtn">–õ–∏—á–Ω–æ ü§ç</button>
          </div>

          <div class="btnRow" style="margin-top:14px;">
            <button class="btn primary" id="to5" disabled style="opacity:.6;">–î–∞–ª—å—à–µ ‚ûú</button>
          </div>
        </div>

        <!-- PAGE 5 -->
        <div class="page" id="p5">
          <h2 class="title">–í–æ —Å–∫–æ–ª—å–∫–æ —Ç—ã –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤–∞? ‚è∞</h2>
          <p class="sub">–í—ã–±–µ—Ä–∏ –≤—Ä–µ–º—è –Ω–∞ 14 —Ñ–µ–≤—Ä–∞–ª—è.</p>
          <div class="divider"></div>

          <div class="btnRow" id="times">
            <button class="btn" data-time="14:00">14:00</button>
            <button class="btn" data-time="15:00">15:00</button>
            <button class="btn" data-time="16:00">16:00</button>
            <button class="btn" data-time="17:00">17:00</button>
            <button class="btn" data-time="18:00">18:00</button>
            <button class="btn" data-time="19:00">19:00</button>
          </div>

          <div class="btnRow" style="margin-top:14px;">
            <button class="btn primary" id="to6" disabled style="opacity:.6;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å ‚úÖ</button>
          </div>
        </div>

        <!-- PAGE 6 -->
        <div class="page" id="p6">
          <div class="finalBanner">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</div>

          <div class="center" style="font-weight:900; margin-bottom:10px;">
            üì∏ –û—Ç–ø—Ä–∞–≤—å —Å–∫—Ä–∏–Ω—à–æ—Ç —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—É
          </div>

          <div class="stats" id="stats"></div>

          <div class="timeBox">
            <div class="miniCard">
              <div class="k">üïí –ê–∫—Ç—É–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–ú–°–ö)</div>
              <div class="v" id="mskNow">‚Äî</div>
            </div>
            <div class="miniCard">
              <div class="k">‚è≥ –î–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—é—Ä–ø—Ä–∏–∑–∞ –æ—Å—Ç–∞–ª–æ—Å—å</div>
              <div class="v" id="countdown">‚Äî</div>
              <div class="muted" style="margin-top:6px; font-size:12px;" id="targetHint">14 —Ñ–µ–≤—Ä–∞–ª—è, –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è</div>
            </div>
          </div>

          <div class="btnRow" style="margin-top:12px;">
            <button class="btn" id="copyStats">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É üìã</button>
          </div>

          <p class="center muted" style="margin:10px 0 0;">(–ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å ‚Äî –∏ –≤—Å—ë –Ω–∞—á–Ω—ë—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏.)</p>
        </div>

      </div>
    </div>

    <div class="foot"></div>
  </div>

<script>
  /***********************
   * RESET STATE ON OPEN
   ***********************/
  try{ localStorage.clear(); sessionStorage.clear(); }catch(e){}

  /***********************
   * BACKGROUND EMOJIS (+15%)
   ***********************/
  const symbols = ["‚ù§Ô∏è","ü§ç","üå∏","üéà","üåπ"];
  const bg = document.getElementById("bg");
  function rand(min,max){ return Math.random()*(max-min)+min; }
  function pick(a){ return a[Math.floor(Math.random()*a.length)]; }

  const baseCount = 16;
  const count = Math.round(baseCount * 1.15); // +15%
  for(let i=0;i<count;i++){
    const el = document.createElement("div");
    el.className="float";
    el.textContent = pick(symbols);

    const size = Math.floor(rand(18, 40));
    el.style.fontSize = size+"px";
    el.style.left = rand(-6, 96)+"%";
    el.style.top = rand(-6, 96)+"%";

    el.style.setProperty("--dx", rand(-24, 24)+"px");
    el.style.setProperty("--dy", rand(-28, 28)+"px");
    el.style.setProperty("--dur", rand(3.6, 6.6)+"s");

    bg.appendChild(el);
  }

  /***********************
   * TOP TOASTS + SHEET
   ***********************/
  const toastLayer = document.getElementById("toastLayer");
  function toast(msg){
    const t = document.createElement("div");
    t.className="toast";
    t.innerHTML = `<div class="dot"></div><div class="t">${msg}</div>`;
    toastLayer.appendChild(t);
    setTimeout(()=>{
      t.style.transition = "opacity .25s ease, transform .25s ease";
      t.style.opacity = "0";
      t.style.transform = "translateY(-10px)";
      setTimeout(()=>t.remove(), 260);
    }, 2400);
  }

  const sheetWrap = document.getElementById("sheetWrap");
  const sheetBackdrop = document.getElementById("sheetBackdrop");
  const sheetClose = document.getElementById("sheetClose");
  const sheetTitle = document.getElementById("sheetTitle");
  const sheetText = document.getElementById("sheetText");
  function openSheet(title, text){
    sheetTitle.textContent = title;
    sheetText.textContent = text;
    sheetWrap.classList.add("show");
    sheetWrap.setAttribute("aria-hidden","false");
  }
  function closeSheet(){
    sheetWrap.classList.remove("show");
    sheetWrap.setAttribute("aria-hidden","true");
  }
  sheetBackdrop.addEventListener("click", closeSheet);
  sheetClose.addEventListener("click", closeSheet);

  /***********************
   * PAGES + PROGRESS
   ***********************/
  const pages = ["p1","p2","p3","p4","p5","p6"].map(id=>document.getElementById(id));
  const progress = document.getElementById("progress");
  const dots = [];
  for(let i=0;i<pages.length;i++){
    const d=document.createElement("div");
    d.className="dotp";
    progress.appendChild(d);
    dots.push(d);
  }
  function showPage(n){
    pages.forEach((p,i)=>p.classList.toggle("show", i===n));
    dots.forEach((d,i)=>d.classList.toggle("on", i<=n));
  }
  showPage(0);

  /***********************
   * STATS (in-memory only)
   ***********************/
  const stats = {
    nameTries: 0,
    giftChoice: "‚Äî",
    delivery: "‚Äî",
    timeChoice: "‚Äî",
    noClicks: 0,
    nameValue: "‚Äî",
    approved: false
  };

  /***********************
   * PAGE 1: Envelope -> reveal activation panel
   ***********************/
  const envelope = document.getElementById("envelope");
  const seal = document.getElementById("seal");
  const activationPanel = document.getElementById("activationPanel");
  const typing1 = document.getElementById("typing1");
  const nameInput = document.getElementById("nameInput");
  const activateBtn = document.getElementById("activateBtn");
  const loaderWrap = document.getElementById("loaderWrap");
  const bar = document.getElementById("bar");
  const percent = document.getElementById("percent");

  let envOpened = false;

  seal.addEventListener("click", ()=>{
    if(envOpened) return; // only open once (clean flow)
    envOpened = true;

    envelope.classList.add("opened");
    activationPanel.classList.add("show");

    typeText(typing1, "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥–ª—è —Ç–µ–±—è‚Ä¶ üíå", 24);
    toast("–ö–æ–Ω–≤–µ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç. –¢–µ–ø–µ—Ä—å ‚Äî –∞–∫—Ç–∏–≤–∞—Ü–∏—è üòâ");

    setTimeout(()=>nameInput.focus(), 450);
  });

  function typeText(el, text, speed=24){
    el.innerHTML = "";
    const span = document.createElement("span");
    const cur = document.createElement("span");
    cur.className="cursor";
    el.appendChild(span);
    el.appendChild(cur);

    let i=0;
    const tick = ()=>{
      span.textContent = text.slice(0,i);
      i++;
      if(i<=text.length) setTimeout(tick, speed);
      else setTimeout(()=>{ if(cur) cur.remove(); }, 450);
    };
    tick();
  }

  function normalizeName(v){
    return (v||"").trim().toLowerCase().replace(/\s+/g," ");
  }
  function isAmina(v){
    const n = normalizeName(v);
    return n === "–∞–º–∏–Ω–∞" || n === "amina";
  }

  let activating = false;

  activateBtn.addEventListener("click", async ()=>{
    if(activating) return;

    const name = nameInput.value;
    stats.nameTries += 1;
    stats.nameValue = name ? name.trim() : "‚Äî";

    if(!envOpened){
      toast("–°–Ω–∞—á–∞–ª–∞ –æ—Ç–∫—Ä–æ–π –∫–æ–Ω–≤–µ—Ä—Ç ‚ù§Ô∏è");
      return;
    }
    if(!name.trim()){
      toast("–í–≤–µ–¥–∏ –∏–º—è üôÇ");
      nameInput.focus();
      return;
    }

    activating = true;
    loaderWrap.classList.add("show");
    typeText(typing1, "–ü—Ä–æ–≤–µ—Ä—è–µ–º‚Ä¶ –µ—â—ë —á—É—Ç—å-—á—É—Ç—å ‚ú®", 22);

    await runLoading();

    if(isAmina(name)){
      stats.approved = true;
      openSheet("‚úÖ –î–æ—Å—Ç—É–ø –æ–¥–æ–±—Ä–µ–Ω üíò", "–ê–º–∏–Ω–∞, –≤—Å—ë —Å–æ–≤–ø–∞–ª–æ. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üôÇ");
      setTimeout(()=>{
        closeSheet();
        document.getElementById("helloTitle").textContent = "–ê–º–∏–Ω–∞, —Ç—ã –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω—è—Ç—å –µ–≥–æ? üíå";
        showPage(1);
      }, 1050);
    }else{
      stats.approved = false;
      openSheet("‚õî –î–æ—Å—Ç—É–ø –æ—Ç–∫–∞–∑–∞–Ω üòå", "–ö–∞–∂–µ—Ç—Å—è, —ç—Ç–æ –Ω–µ –¥–ª—è —Ç–µ–±—è. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≤–µ–¥–∏ –∏–º—è.");
      loaderWrap.classList.remove("show");
      bar.style.width = "0%";
      percent.textContent = "0%";
      activating = false;
    }
  });

  function runLoading(){
    return new Promise((resolve)=>{
      let p = 0;
      percent.textContent = "0%";
      bar.style.width = "0%";
      const timer = setInterval(()=>{
        p += Math.floor(rand(2, 6));
        if(p>100) p=100;
        bar.style.width = p + "%";
        percent.textContent = p + "%";
        if(p===100){
          clearInterval(timer);
          setTimeout(resolve, 220);
        }
      }, 65);
    });
  }

  nameInput.addEventListener("keydown",(e)=>{
    if(e.key==="Enter") activateBtn.click();
  });

  /***********************
   * PAGE 2: NO button scenario (sequential 10, then disable)
   ***********************/
  const yesBtn = document.getElementById("yesBtn");
  const noBtn = document.getElementById("noBtn");
  const arena = document.getElementById("arena");

  const noScenario = [
	"–≠—Ç–æ –±—ã–ª –ø—Ä–æ–±–Ω—ã–π –∫–ª–∏–∫? –ü–æ–ø—Ä–æ–±—É–µ–º –µ—â—ë? üòâ‚ú®",
    "–Ø –ø–æ–Ω—è–ª. –ù–æ —Å—é—Ä–ø—Ä–∏–∑ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª—Å—è –Ω–∞ ¬´–î–∞¬ª üòè",
    "–ú–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —Ç—ã –ø—Ä–æ–º–∞—Ö–Ω—É–ª–∞—Å—å üòá –ë—É–¥—å –ø–æ–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ‚Ä¶ üéØ",
    "–¢—ã —Å–µ–π—á–∞—Å –∫–æ–∫–µ—Ç–Ω–∏—á–∞–µ—à—å, –¥–∞? üòâ",
    "–•–º‚Ä¶ –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–æ–º–∞–Ω—Ç–∏–∫—É –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ üìãüíò",
    "–ö–∞–∂–µ—Ç—Å—è, –∫—Ç–æ-—Ç–æ –ø—Ä–∏—Ç–≤–æ—Ä—è–µ—Ç—Å—è —Å–∫—Ä–æ–º–Ω–æ–π üòè",
    "–¢—ã —Å–µ–π—á–∞—Å —É–ª—ã–±–∞–µ—à—å—Å—è, —è —É–≤–µ—Ä–µ–Ω üòä",
    "–ú–º–º‚Ä¶ —Ç–≤–æ—ë —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –≤—ã–≥–ª—è–¥–∏—Ç –º–∏–ª–æ üòåüíû",
    "–ö–∞–∂–µ—Ç—Å—è, –∫—Ç–æ-—Ç–æ –ª—é–±–∏—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ üòè‚ö°",
    "–¢—ã –ø–æ—á—Ç–∏ –ø–æ–±–µ–¥–∏–ª–∞‚Ä¶ –Ω–æ –∫–Ω–æ–ø–∫–∞ ¬´–î–∞¬ª –≤—Å—ë —Ä–∞–≤–Ω–æ —Å–∏–ª—å–Ω–µ–µ ‚ù§Ô∏è"
  ];

  function moveNoBtn(){
    const rect = arena.getBoundingClientRect();
    const bw = 150;
    const bh = 46;
    const x = rand(10, Math.max(10, rect.width - bw - 10));
    const y = rand(10, Math.max(10, rect.height - bh - 10));
    noBtn.style.left = x + "px";
    noBtn.style.top  = y + "px";
    noBtn.style.transform = "translateX(0)";
  }
  setTimeout(()=>moveNoBtn(), 50);

  noBtn.addEventListener("click", ()=>{
    if(stats.noClicks >= 10) return;

    stats.noClicks += 1;
    const idx = stats.noClicks - 1;

    toast(noScenario[idx] || "–ù–∞–∂–º–∏ ¬´–î–∞¬ª üòâ");
    moveNoBtn();

    if(stats.noClicks >= 10){
      setTimeout(()=>{
        noBtn.classList.add("disabledLike");
        noBtn.textContent = "–ù–µ—Ç üôà (–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ)";
        toast("–¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ ¬´–î–∞¬ª üíò");
      }, 220);
    }
  });

  yesBtn.addEventListener("click", ()=>{
    toast("–ü—Ä–∏–Ω—è—Ç–æ ‚úÖ –ò–¥—ë–º –¥–∞–ª—å—à–µ‚Ä¶");
    showPage(2);
  });

  window.addEventListener("resize", ()=>{
    if(document.getElementById("p2").classList.contains("show")) moveNoBtn();
  });

  /***********************
   * PAGE 3: gift
   ***********************/
  const giftBtns = Array.from(document.querySelectorAll("#p3 .btn[data-gift]"));
  const to4 = document.getElementById("to4");
  function setEnabled(btn, enabled){
    btn.disabled = !enabled;
    btn.style.opacity = enabled ? "1" : ".6";
  }
  giftBtns.forEach(b=>{
    b.addEventListener("click", ()=>{
      giftBtns.forEach(x=>x.classList.remove("primary"));
      b.classList.add("primary");
      stats.giftChoice = b.getAttribute("data-gift");
      openSheet("üíù –í—ã–±–æ—Ä –ø—Ä–∏–Ω—è—Ç", b.getAttribute("data-modal"));
      setEnabled(to4, true);
    });
  });
  to4.addEventListener("click", ()=>showPage(3));

  /***********************
   * PAGE 4: delivery
   ***********************/
  const deliveryBtn = document.getElementById("deliveryBtn");
  const to5 = document.getElementById("to5");
  deliveryBtn.addEventListener("click", ()=>{
    deliveryBtn.classList.add("primary");
    stats.delivery = "–õ–∏—á–Ω–æ";
    openSheet("üöö –°–ø–æ—Å–æ–± –≤—ã–±—Ä–∞–Ω", "–õ–∏—á–Ω–æ ‚Äî –∑–≤—É—á–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ ü§ç");
    setEnabled(to5, true);
  });
  to5.addEventListener("click", ()=>showPage(4));

  /***********************
   * PAGE 5: time
   ***********************/
  const times = document.getElementById("times");
  const to6 = document.getElementById("to6");
  Array.from(times.querySelectorAll(".btn")).forEach(btn=>{
    btn.addEventListener("click", ()=>{
      Array.from(times.querySelectorAll(".btn")).forEach(x=>x.classList.remove("primary"));
      btn.classList.add("primary");
      stats.timeChoice = btn.getAttribute("data-time");
      openSheet("‚è∞ –í—Ä–µ–º—è –ø—Ä–∏–Ω—è—Ç–æ", "–û–∫–µ–π. –Ø –∑–∞–ø–æ–º–Ω–∏–ª üôÇ");
      setEnabled(to6, true);
    });
  });
  to6.addEventListener("click", ()=>{
    showPage(5);
    renderFinal();
    startMskClocks();
  });

  /***********************
   * PAGE 6: final
   ***********************/
  const statsBox = document.getElementById("stats");
  const mskNow = document.getElementById("mskNow");
  const countdown = document.getElementById("countdown");
  const targetHint = document.getElementById("targetHint");
  const copyStatsBtn = document.getElementById("copyStats");

  function escapeHtml(str){
    return String(str ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function renderFinal(){
    statsBox.innerHTML = `
      <p>üíå –ü–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏: <b>${stats.nameTries}</b></p>
      <p>üéÅ –ü–æ–¥–∞—Ä–æ–∫: <b>${escapeHtml(stats.giftChoice)}</b></p>
      <p>üöö –°–ø–æ—Å–æ–±: <b>${escapeHtml(stats.delivery)}</b></p>
      <p>‚è∞ –í—Ä–µ–º—è: <b>${escapeHtml(stats.timeChoice)}</b></p>
      <p>üôÉ –ù–∞–∂–∞—Ç–∏–π ¬´–ù–ï–¢¬ª: <b>${stats.noClicks}</b></p>
    `;
    const timeStr = (stats.timeChoice && stats.timeChoice !== "‚Äî") ? stats.timeChoice : "‚Äî";
    targetHint.textContent = `14 —Ñ–µ–≤—Ä–∞–ª—è, ${timeStr} (–ú–°–ö)`;
  }

  function getMskParts(){
    const parts = new Intl.DateTimeFormat("ru-RU", {
      timeZone: "Europe/Moscow",
      year:"numeric", month:"2-digit", day:"2-digit",
      hour:"2-digit", minute:"2-digit", second:"2-digit",
      hour12:false
    }).formatToParts(new Date());
    const get = (type)=>parts.find(p=>p.type===type)?.value ?? "00";
    return { y:+get("year"), mo:+get("month"), d:+get("day"), h:+get("hour"), mi:+get("minute"), se:+get("second") };
  }
  function buildLocalFromParts(year, month, day, hh, mm, ss){
    return new Date(year, month-1, day, hh, mm, ss, 0);
  }

  let clockTimer = null;
  function startMskClocks(){
    if(clockTimer) return;

    const tick = ()=>{
      const nowP = getMskParts();
      const now = buildLocalFromParts(nowP.y, nowP.mo, nowP.d, nowP.h, nowP.mi, nowP.se);

      mskNow.textContent =
        `${String(nowP.d).padStart(2,"0")}.${String(nowP.mo).padStart(2,"0")}.${nowP.y}  `+
        `${String(nowP.h).padStart(2,"0")}:${String(nowP.mi).padStart(2,"0")}:${String(nowP.se).padStart(2,"0")}`;

      const time = (stats.timeChoice && stats.timeChoice !== "‚Äî") ? stats.timeChoice : "00:00";
      const [th, tm] = time.split(":").map(n=>parseInt(n,10));
      let targetYear = nowP.y;

      let target = buildLocalFromParts(targetYear, 2, 14, (th||0), (tm||0), 0);
      if(target.getTime() < now.getTime()){
        targetYear += 1;
        target = buildLocalFromParts(targetYear, 2, 14, (th||0), (tm||0), 0);
      }

      const diff = Math.max(0, target.getTime() - now.getTime());
      const totalSec = Math.floor(diff/1000);

      const dd = Math.floor(totalSec / 86400);
      const hh = Math.floor((totalSec % 86400) / 3600);
      const mm = Math.floor((totalSec % 3600) / 60);
      const ss = totalSec % 60;

      countdown.textContent = `${dd}–¥ ${String(hh).padStart(2,"0")}—á ${String(mm).padStart(2,"0")}–º ${String(ss).padStart(2,"0")}—Å`;
      targetHint.textContent = `14 —Ñ–µ–≤—Ä–∞–ª—è ${String(th||0).padStart(2,"0")}:${String(tm||0).padStart(2,"0")} (–ú–°–ö)`;
    };

    tick();
    clockTimer = setInterval(tick, 1000);
  }

  copyStatsBtn.addEventListener("click", async ()=>{
    const text =
`üíå –ü–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏: ${stats.nameTries}
üéÅ –ü–æ–¥–∞—Ä–æ–∫: ${stats.giftChoice}
üöö –°–ø–æ—Å–æ–±: ${stats.delivery}
‚è∞ –í—Ä–µ–º—è: ${stats.timeChoice}
üôÉ –ù–∞–∂–∞—Ç–∏–π ¬´–ù–ï–¢¬ª: ${stats.noClicks}`;
    try{
      await navigator.clipboard.writeText(text);
      toast("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ");
    }catch(e){
      openSheet("üìã –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å", "–°–∫–æ–ø–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –±—Ä–∞—É–∑–µ—Ä –∑–∞–ø—Ä–µ—Ç–∏–ª –¥–æ—Å—Ç—É–ø –∫ –±—É—Ñ–µ—Ä—É –æ–±–º–µ–Ω–∞.");
    }
  });
</script>

</body>
</html>
